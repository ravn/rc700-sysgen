;************************************************************************
;* RC702 Boot ROM - Complete Disassembly
;* *** BEST EFFORT - CHECK FOR MISMATCHES ***
;*
;* This is a best-effort disassembly that may not be byte-exact.
;* Compare with original ROM to identify any mismatches.
;*
;* Source: roa375.rom (2048 bytes)
;* Disassembled with z80dasm and converted to zmac syntax
;************************************************************************

.Z80
	ORG	0000H

;========================================================================
; Boot Code Section (runs at 0x0000-0x0067)
;========================================================================

BOOT:
	DI				; Disable interrupts
	LD	SP,0BFFFH		; Set stack pointer

FIND_CODE:
	LD	HL,0068H		; Point to relocated code marker
SCAN:
	LD	A,(HL)			; Scan for start marker
	OR	A
	INC	HL
	JP	Z,SCAN			; Keep scanning if zero
	CP	0FFH			; Check for FF marker
	JP	Z,SKIP
	DEC	HL
SKIP:
	EX	DE,HL			; DE = source address

; Copy code from ROM to RAM at 0x7000
COPY_TO_RAM:
	LD	HL,07000H		; Destination address
	LD	BC,0798H		; Bytes to copy (1944 bytes)
COPY_LOOP:
	LD	A,(DE)
	LD	(HL),A
	INC	DE
	INC	HL
	DEC	BC
	LD	A,C
	OR	B
	JP	NZ,COPY_LOOP
	JP	070D0H			; Jump into relocated code

; Hardware initialization routine (called from relocated code)
INIT_HW:
	LD	A,003H
	LD	(0801CH),A
	INC	A
	LD	(0801DH),A
	LD	(08042H),A
	LD	A,000H
	LD	B,A
	IN	A,(014H)
	AND	080H
	ADD	A,B
	LD	(07320H),A
	XOR	A
	LD	(08033H),A
	LD	(0801BH),A
	LD	(08060H),A
	LD	(08061H),A
	LD	(08041H),A
	LD	C,008H
	LD	HL,08063H
INIT_LOOP:
	LD	(HL),A
	INC	HL
	DEC	C
	JP	NZ,INIT_LOOP
	EI
	LD	A,001H
	OUT	(014H),A
	LD	A,005H
	LD	(08062H),A
	JP	07218H			; Continue in relocated code
	RETN

;========================================================================
; Relocated Code Section (copied to RAM and executed at 0x7000+)
;========================================================================

	PHASE	07000H

RELOCATED:
	RST	38H
	LD	BC,07800H
	LD	DE,0707DH
	LD	HL,0014H
	CALL	07068H
	JP	073DAH
	LD	BC,07800H
	LD	DE,070B0H
	LD	HL,000FH
	CALL	07068H
	JP	073DAH
	LD	BC,07800H
	LD	DE,07092H
	LD	HL,001DH
	CALL	07068H
	JP	073DAH
	PUSH	HL
	INC	HL
	EX	DE,HL
	LD	BC,070C3H
	LD	HL,0004H
	CALL	0705CH
	POP	HL
	JP	Z,0704FH
	RET
	PUSH	HL
	INC	HL
	EX	DE,HL
	LD	BC,070C8H
	LD	HL,0004H
	CALL	0705CH
	POP	HL
	JP	Z,0704FH
	RET
	PUSH	HL
	INC	HL
	LD	DE,0007H
	ADD	HL,DE
	LD	A,(HL)
	AND	03FH
	CP	013H
	POP	HL
	RET

; Compare strings
CMP_STR:
	LD	A,(DE)
	LD	H,A
	LD	A,(BC)
	CP	H
	RET	NZ
	INC	DE
	INC	BC
	DEC	L
	JP	NZ,0705CH
	RET

; Copy memory
COPY_MEM:
	LD	A,(DE)
	LD	(BC),A
	INC	BC
	INC	DE
	DEC	L
	JP	NZ,07068H
	RET

; Error messages and strings
MSG_NO_SYS:
	DB	20H,52H,43H,37H,30H,30H,20H,52H,43H,37H,30H,32H,20H,2AH
	DB	2AH,4EH,4FH,20H,53H,59H,53H,54H,45H,4DH,20H,46H,49H,4CH,45H,53H
	DB	2AH,2AH,20H,20H,2AH,2AH,4EH,4FH,20H,44H,49H,53H,4BH,45H,54H,54H
	DB	45H,20H,4EH,4FH,52H,20H,4CH,49H,4EH,45H,50H,52H,4FH,47H,2AH,2AH
	DB	20H,20H,2AH,2AH,4EH,4FH,20H,4BH,41H,54H,41H,4CH,4FH,47H,2AH,2AH
	DB	20H,02H,0C3H,0C8H,53H,59H,53H,4DH,20H,53H,59H,53H,43H,20H,0C3H,62H
	DB	73H,31H,0FFH,0BFH,3EH,73H,0EDH,47H,0EDH,5EH,0EH,0FFH,06H,01H,0CDH,0B1H
	DB	76H,3EH,99H,0CDH,0E9H,70H,21H,27H,00H,0E9H,0F5H,3EH,02H,0D3H,12H,3EH
	DB	04H,0D3H,13H,3EH,4FH,0D3H,12H,3EH,0FH,0D3H,13H,3EH,83H,0D3H,12H,0D3H
	DB	13H,0C3H,03H,71H,3EH,08H,0D3H,0CH,0F1H,3EH,46H,0F6H,41H,0D3H,0CH,3EH
	DB	20H,0D3H,0CH,3EH,46H,0F6H,41H,0D3H,0DH,3EH,20H,0D3H,0DH,3EH,0D7H,0D3H
	DB	0EH,3EH,01H,0D3H,0EH,3EH,0D7H,0D3H,0FH,3EH,01H,0D3H,0FH,0C3H,2FH,71H
	DB	3EH,20H,0D3H,0F8H,3EH,0C0H,0D3H,0FBH,3EH,00H,0D3H,0FAH,3EH,4AH,0D3H,0FBH
	DB	3EH,4BH,0D3H,0FBH,0C3H,46H,71H,3EH,00H,0D3H,01H,3EH,4FH,0D3H,00H,3EH
	DB	98H,0D3H,00H,3EH,9AH,0D3H,00H,3EH,5DH,0D3H,00H,3EH,80H,0D3H,01H,0AFH
	DB	0D3H,00H,0D3H,00H,3EH,0E0H,0D3H,01H,0C3H,6EH,71H,03H,03H,4FH,20H,0EH
	DB	0FFH,06H,01H,0CDH,0B1H,76H,0DBH,04H,0E6H,1FH,0C2H,6EH,71H,21H,6AH,71H
	DB	46H,23H,0DBH,04H,0E6H,0C0H,0FEH,80H,0C2H,81H,71H,7EH,0D3H,05H,05H,0C2H
	DB	80H,71H,0C3H,94H,71H,21H,00H,00H,0EBH,21H,00H,78H,19H,3EH,20H,77H
	DB	7BH,0FEH,0CFH,0CAH,0A9H,71H,13H,0C3H,98H,71H,7AH,0FEH,07H,0CAH,0B3H,71H
	DB	13H,0C3H,98H,71H,11H,71H,70H,21H,06H,00H,01H,00H,78H,0CDH,68H,70H
	DB	21H,00H,00H,22H,0D2H,7FH,22H,0D9H,7FH,22H,0E4H,7FH,22H,0E2H,7FH,22H
	DB	0E0H,7FH,22H,0D7H,7FH,22H,0DEH,7FH,22H,0D5H,7FH,21H,80H,07H,22H,0DBH
	DB	7FH,3EH,00H,32H,0D1H,7FH,32H,0D4H,7FH,32H,0DDH,7FH,32H,0E6H,7FH,3EH
	DB	23H,0D3H,01H,0C9H,0AFH,32H,32H,80H,3CH,32H,33H,80H,32H,34H,80H,0CDH
	DB	0CBH,74H,0DAH,0BH,72H,21H,20H,73H,3EH,02H,0B6H,77H,21H,33H,80H,35H
	DB	0CDH,0CBH,74H,0D0H,3EH,0FBH,0C3H,0C4H,72H,06H,01H,0EH,0FFH,0CDH,0B1H,76H
	DB	0CDH,72H,76H,3AH,10H,80H,0E6H,23H,4FH,3AH,1BH,80H,0C6H,20H,0B9H,0C2H
	DB	0C4H,72H,0CDH,0BH,77H,0DAH,0C4H,72H,0CAH,3DH,72H,0C3H,0C4H,72H,0CDH,0F3H
	DB	71H,3EH,01H,0D3H,18H,2AH,67H,80H,0CDH,25H,74H,3AH,32H,80H,0B7H,0C2H
	DB	57H,72H,0CDH,0CBH,74H,0C3H,44H,72H,3EH,01H,32H,60H,80H,0CDH,62H,72H
	DB	0C3H,03H,74H,3EH,0AH,21H,00H,00H,0CDH,0AAH,72H,0CAH,7CH,72H,3EH,0BH
	DB	0CDH,0AAH,72H,0CAH,78H,72H,0C3H,0FH,70H,2AH,00H,00H,0E9H,21H,00H,00H
	DB	11H,60H,0BH,19H,11H,20H,00H,19H,01H,00H,0DH,78H,0BCH,0DAH,00H,70H
	DB	7EH,0B7H,0CAH,83H,72H,0CDH,2DH,70H,0C2H,00H,70H,11H,20H,00H,19H,7EH
	DB	0B7H,0CAH,00H,70H,0CDH,3EH,70H,0C2H,00H,70H,0C9H,11H,02H,00H,19H,0EBH
	DB	01H,71H,70H,21H,06H,00H,0FEH,0AH,0CAH,0C0H,72H,01H,77H,70H,21H,06H
	DB	00H,0CDH,5CH,70H,0C9H,3EH,0BH,21H,00H,20H,0CDH,0AAH,72H,0CAH,0D2H,72H
	DB	0C3H,1EH,70H,2AH,00H,20H,0E9H,1AH,07H,34H,07H,0FH,0EH,1AH,0EH,08H
	DB	1BH,0FH,1BH,00H,00H,08H,35H,10H,07H,20H,07H,09H,0EH,10H,0EH,05H
	DB	1BH,09H,1BH,00H,00H,05H,35H,00H,00H,00H,00H,00H,00H,00H,00H,00H
	DB	00H,0C6H,73H,0C6H,73H,0C6H,73H,0C6H,73H,0C6H,73H,0C6H,73H,0BBH,73H,0C2H
	DB	73H,0C6H,73H,0C6H,73H,0C6H,73H,0C6H,73H,0C6H,73H,0C6H,73H,0C6H,73H,0C6H
	DB	73H,00H,00H,22H,65H,80H,21H,00H,00H,39H,22H,1EH,80H,0C5H,0EBH,79H
	DB	0E6H,7FH,32H,34H,80H,78H,0E6H,7FH,32H,32H,80H,0CCH,0CBH,74H,78H,0E6H
	DB	80H,0CAH,45H,73H,3EH,01H,32H,33H,80H,0CDH,25H,74H,0C1H,0F5H,78H,0E6H
	DB	7FH,0C2H,5BH,73H,3EH,01H,32H,32H,80H,0CDH,0CBH,74H,0F1H,0AFH,2AH,1EH
	DB	80H,0F9H,0C9H,0F5H,0DBH,01H,0E5H,0D5H,0C5H,3EH,06H,0D3H,0FAH,3EH,07H,0D3H
	DB	0FAH,0D3H,0FCH,2AH,0D5H,7FH,11H,00H,78H,19H,7DH,0D3H,0F4H,7CH,0D3H,0F4H
	DB	7DH,2FH,6FH,7CH,2FH,67H,23H,11H,0CFH,07H,19H,11H,00H,78H,19H,7DH
	DB	0D3H,0F5H,7CH,0D3H,0F5H,21H,00H,78H,7DH,0D3H,0F6H,7CH,0D3H,0F6H,21H,0CFH
	DB	07H,7DH,0D3H,0F7H,7CH,0D3H,0F7H,3EH,02H,0D3H,0FAH,3EH,03H,0D3H,0FAH,0C1H
	DB	0D1H,0E1H,3EH,0D7H,0D3H,0EH,3EH,01H,0D3H,0EH,0F1H,0C9H,0F3H,0CDH,62H,73H
	DB	0FBH,0EDH,4DH,0F3H,0C3H,70H,77H,0FBH,0EDH,4DH,32H,03H,80H,0FBH,3AH,60H
	DB	80H,0E6H,01H,0C2H,5DH,73H,0D3H,1CH,0CDH,0DEH,73H,0B7H,0C3H,0DAH,73H,01H
	DB	00H,78H,11H,0F0H,73H,21H,12H,00H,1AH,02H,03H,13H,2DH,0C2H,0E7H,73H
	DB	0C9H,2AH,2AH,44H,49H,53H,4BH,45H,54H,54H,45H,20H,45H,52H,52H,4FH
	DB	52H,2AH,2AH,20H,3AH,20H,73H,0E6H,80H,21H,60H,80H,0B6H,77H,35H,0CDH
	DB	0CBH,74H,21H,00H,00H,22H,65H,80H,21H,00H,73H,0CDH,25H,74H,3EH,01H
	DB	32H,60H,80H,0C3H,00H,10H,3EH,00H,22H,69H,80H,0CDH,21H,77H,0DAH,0C4H
	DB	72H,0CAH,38H,74H,3EH,06H,0C3H,0C9H,73H,0CDH,81H,74H,3EH,06H,0EH,05H
	DB	0CDH,83H,75H,0D2H,4AH,74H,3EH,28H,0C3H,0C9H,73H,2AH,67H,80H,0EBH,2AH
	DB	65H,80H,19H,22H,65H,80H,2EH,00H,65H,22H,67H,80H,0CDH,66H,74H,3AH
	DB	61H,80H,0B7H,0C8H,0C3H,2AH,74H,3EH,01H,32H,34H,80H,3AH,20H,73H,0E6H
	DB	02H,0FH,21H,33H,80H,0BEH,0CAH,7AH,74H,34H,0C9H,0AFH,77H,21H,32H,80H
	DB	34H,0C9H,2AH,69H,80H,0E5H,0CDH,47H,75H,0CDH,0AEH,74H,0D1H,19H,0D2H,9EH
	DB	74H,7CH,0B5H,0CAH,9EH,74H,3EH,01H,32H,61H,80H,22H,69H,80H,0C9H,3EH
	DB	00H,32H,61H,80H,32H,69H,80H,32H,6AH,80H,0EBH,22H,67H,80H,0C9H,0F5H
	DB	7DH,2FH,6FH,7CH,2FH,67H,23H,0F1H,0C9H,3AH,20H,73H,0E6H,1CH,1FH,1FH
	DB	0E6H,07H,32H,35H,80H,0CDH,0AH,75H,0CDH,47H,75H,0C9H,3AH,20H,73H,0E6H
	DB	0FEH,32H,20H,73H,0CDH,21H,77H,0C2H,08H,75H,2EH,04H,26H,00H,22H,67H
	DB	80H,3EH,0AH,0EH,01H,0CDH,83H,75H,21H,20H,73H,0D2H,0F7H,74H,7EH,0E6H
	DB	01H,0C2H,08H,75H,34H,0C3H,0D3H,74H,3AH,16H,80H,07H,07H,47H,7EH,0E6H
	DB	0E3H,80H,77H,0CDH,0B8H,74H,37H,3FH,0C9H,37H,0C9H,3AH,35H,80H,17H,17H
	DB	5FH,16H,00H,21H,0D6H,72H,3AH,20H,73H,0E6H,80H,3EH,4CH,0CAH,24H,75H
	DB	3EH,23H,21H,0E6H,72H,32H,0CH,80H,19H,3AH,20H,73H,0E6H,01H,0CAH,35H
	DB	75H,1EH,02H,16H,00H,19H,0EBH,21H,36H,80H,1AH,77H,32H,0DH,80H,23H
	DB	13H,1AH,77H,23H,3EH,80H,77H,0C9H,21H,80H,00H,3AH,35H,80H,0B7H,0CAH
	DB	56H,75H,29H,3DH,0C2H,51H,75H,22H,39H,80H,0EBH,3AH,34H,80H,6FH,3AH
	DB	36H,80H,95H,3CH,6FH,3AH,60H,80H,0E6H,80H,0CAH,76H,75H,3AH,33H,80H
	DB	0EEH,01H,0C2H,76H,75H,2EH,0AH,7DH,2EH,00H,65H,19H,3DH,0C2H,7AH,75H
	DB	22H,67H,80H,0C9H,0F5H,79H,32H,62H,80H,0CDH,9DH,76H,2AH,67H,80H,44H
	DB	4DH,0BH,2AH,65H,80H,0F1H,0F5H,0E6H,0FH,0FEH,0AH,0C4H,32H,76H,0F1H,4FH
	DB	0CDH,0DDH,75H,3EH,0FFH,0CDH,0C3H,76H,0D8H,79H,0CDH,0B3H,75H,0D0H,0C8H,79H
	DB	0F5H,0C3H,88H,75H,21H,10H,80H,7EH,0E6H,0C3H,47H,3AH,1BH,80H,0B8H,0C2H
	DB	0D4H,75H,23H,7EH,0FEH,00H,0C2H,0D4H,75H,23H,7EH,0E6H,0BFH,0FEH,00H,0C2H
	DB	0D4H,75H,37H,3FH,0C9H,3AH,62H,80H,3DH,32H,62H,80H,37H,0C9H,0C5H,0F5H
	DB	0F3H,3EH,0FFH,21H,30H,80H,32H,0BH,80H,3AH,20H,73H,0E6H,01H,0CAH,0F2H
	DB	75H,3EH,40H,47H,0F1H,0F5H,80H,77H,23H,0CDH,0A4H,76H,77H,2BH,0F1H,0E6H
	DB	0FH,0FEH,06H,0EH,09H,0CAH,09H,76H,0EH,02H,7EH,23H,0CDH,3CH,76H,0DH
	DB	0C2H,09H,76H,0C1H,0FBH,0C9H,3EH,05H,0F3H,0D3H,0FAH,3EH,49H,0D3H,0FBH,0D3H
	DB	0FCH,7DH,0D3H,0F2H,7CH,0D3H,0F2H,79H,0D3H,0F3H,78H,0D3H,0F3H,3EH,01H,0D3H
	DB	0FAH,0FBH,0C9H,3EH,05H,0F3H,0D3H,0FAH,3EH,45H,0C3H,1CH,76H,0F5H,0C5H,06H
	DB	00H,0EH,00H,04H,0CCH,6AH,76H,0DBH,04H,0E6H,0C0H,0FEH,80H,0C2H,42H,76H
	DB	0C1H,0F1H,0D3H,05H,0C9H,0C5H,06H,00H,0EH,00H,04H,0CCH,6AH,76H,0DBH,04H
	DB	0E6H,0C0H,0FEH,0C0H,0C2H,59H,76H,0C1H,0DBH,05H,0C9H,06H,00H,0CH,0C0H,0FBH
	DB	0C3H,0C4H,72H,3EH,04H,0CDH,3CH,76H,3AH,1BH,80H,0CDH,3CH,76H,0CDH,54H
	DB	76H,32H,10H,80H,0C9H,3EH,08H,0CDH,3CH,76H,0CDH,54H,76H,32H,10H,80H
	DB	0E6H,0C0H,0FEH,80H,0CAH,9CH,76H,0CDH,54H,76H,32H,11H,80H,0C9H,0F3H,0AFH
	DB	32H,41H,80H,0FBH,0C9H,0D5H,3AH,33H,80H,17H,17H,57H,3AH,1BH,80H,82H
	DB	0D1H,0C9H,0F5H,0E5H,61H,2EH,0FFH,2BH,7DH,0B4H,0C2H,0B6H,76H,05H,0C2H,0B3H
	DB	76H,0E1H,0F1H,0C9H,0C5H,3DH,37H,0CAH,0DFH,76H,06H,01H,0EH,01H,0CDH,0B1H
	DB	76H,47H,3AH,41H,80H,0E6H,02H,78H,0CAH,0C4H,76H,37H,3FH,0CDH,9DH,76H
	DB	0C1H,0C9H,3EH,0FFH,0CDH,0C3H,76H,3AH,10H,80H,47H,3AH,11H,80H,4FH,0C9H
	DB	3EH,07H,0CDH,3CH,76H,3AH,1BH,80H,0CDH,3CH,76H,0C9H,3EH,0FH,0CDH,3CH
	DB	76H,7AH,0E6H,07H,0CDH,3CH,76H,7BH,0CDH,3CH,76H,0C9H,0CDH,0EFH,76H,0CDH
	DB	0E1H,76H,0D8H,3AH,1BH,80H,0C6H,20H,0B8H,0C2H,1EH,77H,79H,0FEH,00H,37H
	DB	3FH,0C9H,3AH,32H,80H,5FH,0CDH,0A4H,76H,57H,0CDH,0FBH,76H,0CDH,0E1H,76H
	DB	0D8H,3AH,1BH,80H,0C6H,20H,0B8H,0C2H,3DH,77H,3AH,32H,80H,0B9H,37H,3FH
	DB	0C9H,21H,10H,80H,06H,07H,78H,32H,0BH,80H,0CDH,54H,76H,77H,23H,3AH
	DB	1DH,80H,3DH,0C2H,51H,77H,0DBH,04H,0E6H,10H,0CAH,65H,77H,05H,0C2H,49H
	DB	77H,3EH,0FEH,0C3H,0C9H,73H,0DBH,0F8H,77H,05H,0C8H,0FBH,3EH,0FDH,0C3H,0C9H
	DB	73H,0F5H,0C5H,0E5H,3EH,02H,32H,41H,80H,3AH,1CH,80H,3DH,0C2H,7BH,77H
	DB	0DBH,04H,0E6H,10H,0C2H,8CH,77H,0CDH,84H,76H,0C3H,8FH,77H,0CDH,40H,77H
	DB	0E1H,0C1H,0F1H,0FBH,0EDH,4DH,00H,00H

	DEPHASE

	END
